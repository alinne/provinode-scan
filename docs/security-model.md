# Security Model (M1)

- Pairing uses short code + nonce generated by desktop receiver.
- Desktop pairing endpoint discovery uses mDNS advertisement with non-sensitive metadata only.
- Pairing request uses HTTPS with desktop cert fingerprint pinning from mDNS metadata.
- Pairing lockout is enforced by desktop after repeated invalid codes.
- Scanner identity is persisted locally as a long-lived signing key.
- Scanner client mTLS credential payload is encrypted at rest (AES-GCM) before local persistence.
- Trust records are persisted locally with paired desktop device ID + desktop certificate fingerprint hash for live-stream pinning.
- Trust records are encrypted at rest (AES-GCM) with backward-compatible legacy plaintext read support.
- Pairing response bootstraps a scanner client mTLS credential that is persisted locally for QUIC client authentication.
- Stream transport uses QUIC + TLS 1.3 with pinned-fingerprint server verification and scanner client certificate presentation.
- Secure-channel hello carries scanner device identity + fingerprint + scanner signing public key + signed hello proof.
- Resume checkpoints and backpressure hints are exchanged on encrypted control payloads.
- Scanner buffers recent sample frames and replays missing tail samples when desktop sends resume control requests.
- Every sample payload is SHA-256 hashed before recording and streaming.
